sudo: required
language: android
jdk: oraclejdk8
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -rf $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
  - "$HOME/.android/build-cache"
env:
  global:
  - ANDROID_API=26
  - ANDROID_BUILD_TOOLS=27.0.3
  - ADB_INSTALL_TIMEOUT=10
  - secure: THffcyTATxCglHjMWg9raOv2RxRr9ylVOiFOSsx3pXqVAUMkawq9D4PrRRDR6KJwzsf0FDRIRRZ30nUFX4OVpY25vuOYZMlqu68ZRUi8xajBe5Ire9R3ttqqS5n1XHVydt9YbUj5CaKCfFVnbjsriU8vvvwW91TLCNkHuoGjI+bnW3AuyACUyxoNweAna250tDJXWWoNmOXXNJi7G7K6UrvOCYHiv5S2dew3MUeIMRS72dWdd92fTeDWqLA/IpbRsG5tlgCF2lw/CWt+uBpjJNY4NBYYtw17dc5AuFRQoVOuicLVPlgNjiLBm0s7av6SDSewtJ7lH7w/Ilv49gS3zj2YTFtj5bynDsNKm+jQISuC+n5RcroGq5IJ32p+Bkrt1Qzq9NqQmP8RorFupNCq7MOaV9ZMHK1wsYllSmwCl8u3PNpDBIZOFpBVmgIyRGAXXmBpZGM3jhtCsBc1ao4r8ngqYID0sPL/scIjdm+/uILdkjnSYBi9C3sV7vZ2g6KWww6Rb86fvH4/eIMv6/cSas/Ni0CsTO6TJILiaXF1YzdVtfxA6+N5jGD10XorFNL0rv6YwLGTRLPaRehInapgGCMrn/aW5hPScTR3KnXewfIAx9CuFczXRdRLtgj8XpggJmhYAF6wHKQ1NFwy/RgomepenAfIYNy76I/g9hawyCU=
  - secure: GJDxM/Ixagaul+9mOcfXBDAEXPcjiGmdyESrxZBn9ukKbMLh/t8uNENbDUFFmeCtYllTRXs4inpQk5d48lEkYPMuGMYV+5U6MW9gWYKiOxx2tJpg3kRkS+JwpOGmqoVKHoHEnh4pXzrtbwPOdvszJMDXL1R2XT8zu3vvPf+uAg378CHfAdeus/+VuZ0oFVkTxPfSR3vwJCKkqqzC9GFwaaMTzpumeVTOqgzWGBYeKcOULJRSI7p1X+yttk1F+iMgBcra38Hn6Ht+vYTwT+kEHdK02mL+6uT0WO1XzfyCTsyzYWuQMEPT6wsg6T6v2hqYibmeUTT0X/LiO9HHP+3v9uABapuZEXaUJOvXCIkEZ5TUFhntYGnZicRdy7a3IVprbj6EDdeyOYJ03uKpetPGOcdJw1qO+HZzoPvxVfyZMHbVqDwby21Pvnn22N7rme84lVJA4lBo0vqPZoC1i0+pF7nDbQg1A0xz9sJW7JwlLZuRe8s1jdnqbbBDvzGRVGDK2oXjXx+9aq4bv5fVNkA3TvreZqbTr42Gut5YxD0L9FcYBfhWQgUW+JBQZxDN8OvHvOUY3+5a7bpJxRl05MZxGONaytAvH7V4Cu6ti4cefSSEA+ZzIdH/g+qfG8ZqZPmc0z4otqACoypb/8cEA8dbbo8nhwzxCRP11UhB1NWsO5s=
  - secure: YGlSNq/u/qRLH0bsEZpRhyF4kadAMh5Fg8mr2vOhi7LqJFKzIW2eoDOzs39o9HoCIsV/G6CLTnhcE9riQCUppRQWJFZXmCc+stGrP9K9y2UEICKHv5Yd7a/lkOtgKZZ/sK2mF+u2B+iEPzNkqkpLSjGGDS8hWLxFMQa4ey6Hhsl2C4zUvjGE6ohWq+qaKCbaCF8w1O6j++zz/EylBObFV7lCNaiZqoUyUA/McFwkCa/uRwL5+eQqFIHKrgypYJ/JzzilnPG3RRNN3FUzfw6MUaK/QOMtFXvNS3YBv0yw6HcR00qILOMdJfGFYN8MsCKkKSdLhkqn+9ovWpgWZXW4hKfnwMiWJjPcjNtnI6i2dXozbS6hDcf3o8OirWKpJl3J1L+u7CzKU+MqiCbDKGFehRW6hLnYi1rGx75Qtjqwxfnx8jhtcK1CQmGqzQXhWISYKUQfmJ1/Io3bFsn72jlq0jV49ZFYvAq4Jo38pkZWqwi0d+iqUXg3NKiuhUbJGZfgzdgFDR18YwGlplq4v0qwyVblDCl/RUZ0Oo+yMrM/E3aQWY1eS82mDqxsbHmrVEcNhgNCMEJc+ghVpU1BZapR6WfdmHLq6J2vxs3VT9z0HwICf00jBHHuDTmH9NEv8HTj9fapjPsnMMGC4z1MH5c5F5KOZAuO8ik+jAEf8esZdZQ=
licenses:
- android-sdk-license-.+
android:
  components:
  - tools
  - platform-tools
  - tools
  - android-${ANDROID_API}
  - build-tools-${ANDROID_BUILD_TOOLS}
  - extra
before_install:
- yes | sdkmanager "platforms;android-26"
before_script:
- chmod +x gradlew
script:
- "./gradlew clean test build"
before_deploy:
- openssl aes-256-cbc -K $encrypted_747074ef15ef_key -iv $encrypted_747074ef15ef_iv
  -in keystore.jks.enc -out keystore.jks -d
- cd app/build/outputs/apk/release
- jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore ${TRAVIS_BUILD_DIR}/keystore.jks
  -storepass $storepass -keypass $keypass app-release-unsigned.apk key
- jarsigner -verify app-release-unsigned.apk
- "${ANDROID_HOME}/build-tools/${ANDROID_BUILD_TOOLS}/zipalign -v 4 app-release-unsigned.apk
  TravisAndroid.apk"
- cd -
- scripts/tag.sh
deploy:
  provider: releases
  on:
    branch: master
  api_key:
    secure: exFqPu6pEM7mRpeQQq6zuGUIbJwNwe5FszSHExFLwGP8+qUOPBb48OI6NvYFTbAcetHGKqXdfC1fbWNUkGlK6JIZfmAlfHocLd2HjUNmCNseh9wZ6EoWFbBANuT8ApxkkhVSM5e2TQ86/s7ndt6xKuHzgxdA3kNE2XQqsR1axQelWA0vGfZym5ICqOwmZrJkFIpbGvrnNp1s3wARrJ2M7YVXqQQTaPzC6Bk0OBVQOkacS/ApigKWjdDnPcJLdpJPXFa7pz5aAYjtMfhiS6ZSUrTCQwuAHDOYknTaA4sLm5qhwC/t1MqOswtHb7mrVAAgd14+3RSO8QlCxxP7WW/yiFdaiSVAGZ+Pqo1Je9GoZr6sl4iIuYcKJ/3A01Shtf9+YM2PXc35z5MM583e5vX9uonAsBSzl6E3k7hc5EOyjZe8C5buWzhQ2A+RB9kJ65lau5SZOidIAkFizS71hrKfRykC6gs4RIpzPqvjgm+AFBiXDaC+1ZIkDWo7YSS4QtbQddRMpIovxmN8YbQPa3HA+8tAl7HSUanjHH+PzuLyPJ8wYb1BIh4X0dr97OG5YFKotmI17zHjATId4WngQBEaSo1FOaz0K3nLfLP3a6l9pzStUXYayhcbmaFhe8+zUlRz7t57ynTsv/6jiYZV8Yf2t9ZMM+zX1Zlw1rs1wK5JVws=
  file: app/build/outputs/apk/release/TravisAndroid.apk
  overwrite: true
skip_cleanup: true
